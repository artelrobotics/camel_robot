<?xml version="1.0"?>
<launch>
    <arg name="front_lidar_ip"        default="192.168.1.3" />
    <arg name="back_lidar_ip"         default="192.168.1.4" />
    <arg name="common_modbus_ip"      default="192.168.1.111" />
    <arg name="lights_modbus_ip"      default="192.168.1.112" />
    <arg name="robot_name"            default="$(env ROBOT_NAME)" />
    <arg name="base_frame"            default="base_link" />
    <arg name="output"                default="screen" />
    <arg name="ws_port"               default="9090"/>
    <arg name="pub_tf"                default="true"/>


    <node name = "driver" pkg = "roboteq_motor_controller_driver" type = "roboteq_motor_controller_driver_node" output="$(arg output)" required='true'>
        <rosparam command="load" file="$(find camel_robot)/config/bringup/motor_driver_config.yaml" />
        <param name="port"  value="/dev/RoboteqDriver"/>
        <param name="baud"  value="115200"/>
    </node>


    <node pkg="razor_imu_9dof" type="imu_node.py" name="imu_node" output="$(arg output)" required='true'>
        <rosparam file="$(find camel_robot)/config/bringup/razor_imu_config.yaml" command="load"/>
        <param name="port"       value="/dev/ttyIMU"/>
        <param name="frame_id"   value="$(arg robot_name)/imu"/>
        <remap from="/$(arg robot_name)/imu" to="/$(arg robot_name)/imu/data_raw"/>
    </node>

    <node pkg="imu_complementary_filter" type="complementary_filter_node" name="complementary_filter" output="$(arg output)" required='true'>
        <param name="do_bias_estimation" value="true"/>
        <param name="do_adaptive_gain"   value="true"/>
        <param name="use_mag"            value="false"/>
        <param name="gain_acc"           value="0.01"/>
        <param name="gain_mag"           value="0.01"/>
        <param name="fixed_frame"        value="$(arg robot_name)/base_link"/>
        <param name="publish_tf"         value="$(arg pub_tf)"/> 
    </node>


     <node name="zed" pkg="zed_wrapper" type="zed_wrapper_node" output="$(arg output)" ns="front" required="true">
        <rosparam file="$(find camel_robot)/config/bringup/zed2_front_config.yaml" command="load" />
        <rosparam file="$(find camel_robot)/config/bringup/zed2_common_config.yaml" command="load" />
        <param name="general/camera_name"               value="$(arg robot_name)/zed_front" />
        <param name="general/base_frame"                value="$(arg robot_name)/$(arg base_frame)" />
        <param name="svo_file"                          value="" />
        <param name="stream"                            value="" />
        <param name="general/zed_id"                    value="0" />
        <param name="general/gpu_id"                    value="-1" />
        <param name="general/serial_number"             value="28998504" />
    </node>

</launch>