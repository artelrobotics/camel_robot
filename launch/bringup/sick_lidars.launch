<?xml version="1.0"?>
<launch>
    <arg name="front_lidar_ip"        default="192.168.1.3" />
    <arg name="back_lidar_ip"         default="192.168.1.4" />
    <arg name="robot_name"            default="$(env ROBOT_NAME)" />
    <arg name="output"                default="screen" />

    <!-- Front Lidar -->
    <include file="$(find camel_robot)/launch/bringup/sick_scan.launch">
        <arg name="lidar_ip"              value="$(arg front_lidar_ip)" />
        <arg name="robot_name"            value="$(arg robot_name)" />
        <arg name="output"                value="screen" />
        <arg name="ns"                    value="front_lidar" />
        <arg name="frame_id"              value="$(arg robot_name)/front_lidar" />
    </include>

    <!-- Back Lidar -->
    <include file="$(find camel_robot)/launch/bringup/sick_scan.launch">
        <arg name="lidar_ip"              value="$(arg back_lidar_ip)" />
        <arg name="robot_name"            value="$(arg robot_name)" />
        <arg name="output"                value="screen" />
        <arg name="ns"                    value="back_lidar" />
        <arg name="frame_id"              value="$(arg robot_name)/back_lidar" />
    </include>

    <!-- Two lidars merger -->
    <node pkg="ira_laser_tools" name="scan_merger" type="laserscan_multi_merger" output="$(arg output)">
        <param name="destination_frame" value="$(arg robot_name)/laser"/>
        <param name="cloud_destination_topic" value="/$(arg robot_name)/merged_cloud"/>
        <param name="scan_destination_topic" value="/$(arg robot_name)/scan"/>
        <param name="laserscan_topics" value ="/$(arg robot_name)/front_lidar/scan /$(arg robot_name)/back_lidar/scan" />
        <param name="angle_min" value="-3.14159265359"/>
        <param name="angle_max" value="3.14159265359"/>
        <param name="angle_increment" value="0.004363323096185923"/>
        <param name="scan_time" value="0.03999999910593033"/>
        <param name="range_min" value="0.05"/>
        <param name="range_max" value="20.0"/>
    </node>
    
</launch>